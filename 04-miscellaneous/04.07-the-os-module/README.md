# Введение в модуль `os`

В этом разделе Вы узнаете о модуле под названием `os`, который позволяет **взаимодействовать с операционной системой с помощью Python**.

Он предоставляет функции, доступные в системах Unix и/или Windows. Если Вы знакомы с командной строкой, Вы увидите, что некоторые функции дают те же результаты, что и команды, доступные в операционных системах.

Хорошим примером этого является функция `mkdir`, которая позволяет создавать каталог точно так же, как команда `mkdir` в Unix и Windows. Если Вы не знаете эту команду, не волнуйтесь.

Скоро у Вас будет возможность изучить функции модуля `os` для выполнения операций с файлами и каталогами вместе с соответствующими командами.

Помимо операций с файлами и каталогами, модуль `os` позволяет:

*   получить информацию об операционной системе;
*   управлять процессами;
*   оперировать потоками ввода-вывода с помощью файловых дескрипторов.


![A penguin, a snake, and a window](./assets/acff888e657173efaea1bc8feacc5a61c1190038.png)


Через мгновение Вы увидите, как получить основную информацию о Вашей операционной системе, хотя управление процессами и работа с файловыми дескрипторами здесь не обсуждаются, потому что это более сложные темы, требующие знания механизмов операционной системы.

Готовы?


# Получение информации об операционной системе

Прежде чем Вы создадите свою первую структуру каталогов, Вы увидите, как получить информацию о текущей операционной системе. Это действительно просто, потому что модуль `os` предоставляет функцию с именем `uname`, которая возвращает объект, содержащий следующие атрибуты:

*   **systemname** — хранит имя операционной системы;
*   **nodename** — хранит имя машины в сети;
*   **release** — хранит выпуск операционной системы;
*   **version** — хранит версию операционной системы;
*   **machine** — хранит идентификатор оборудования, например x86_64.

Посмотрим, как это работает на практике:

```python
import os print(os.uname())
```

Результат:

```
posix.uname_result(sysname='Linux', nodename='192d19f04766', release='4.4.0-164-generic', version='#192-Ubuntu SMP Fri Sep 13 12:02:50 UTC 2019', machine='x86_64')
```

Как видите, функция `uname` возвращает объект, содержащий информацию об операционной системе. Приведенный выше код был запущен в Ubuntu 16.04.6 LTS, поэтому не удивляйтесь, если Вы получите другой результат, потому что он зависит от Вашей операционной системы.

К сожалению, функция `uname` работает только в некоторых системах Unix. Если вы используете Windows, вы можете использовать функцию `uname` в модуле `platform`, которая возвращает аналогичный результат.

Модуль `os` позволяет быстро идентифицировать операционную систему с помощью атрибута `name`, который поддерживает одно из следующих имен:

*   **posix** — Вы получите это имя, если используете Unix;
*   **nt** — Вы получите это имя, если используете Windows;
*   **java** — Вы получите это имя, если Ваш код написан в Jython.

Для Ubuntu 16.04.6 LTS атрибут `name` возвращает имя `posix`:

```python
import os print(os.name)
```

Результат:

```
posix
```

**ПРИМЕЧАНИЕ:** В системах Unix есть команда с именем `uname`, которая возвращает ту же информацию (если Вы запускаете ее с параметром `-a`), что и функция `uname`.


# Создание директорий в Python

Модуль `os` предоставляет функцию под названием `mkdir`, которая, как и команда `mkdir` в Unix и Windows, позволяет Вам создавать каталог. Для функции `mkdir` требуется путь, который может быть относительным или абсолютным. Напомним, как выглядят оба пути на практике.:

*   `my_first_directory` - это относительный путь, по которому будет создан каталог _my_first_directory_ в текущем рабочем каталоге;
*   `./my_first_directory` - это относительный путь, который явно указывает на текущий рабочий каталог. Он имеет тот же эффект, что и путь выше;
*   `../my_first_directory` - это относительный путь, по которому будет создан каталог _my_first_directory_ в родительском каталоге текущего рабочего каталога;
*   `/python/my_first_directory` - это абсолютный путь, по которому будет создан каталог _my_first_directory_, который, в свою очередь, находится в каталоге _python_ в корневом каталоге.

Посмотрите код. Он показывает пример того, как создать каталог _my_first_directory_, используя относительный путь. Это простейший вариант относительного пути, который состоит из передачи только имени каталога.

```python
import os

os.mkdir("my_first_directory")
print(os.listdir())

```

Если Вы протестируете здесь свой код, он выведет только что созданный каталог `['my_first_directory']` (и все содержимое текущего рабочего каталога).

Функция `mkdir` создает каталог по указанному пути. Обратите внимание, что запуск программы дважды вызовет ошибку `FileExistsError`.

Это означает, что мы не можем создать каталог, если он уже существует. В дополнение к аргументу пути функция `mkdir` может дополнительно принимать аргумент `mode`, который определяет права доступа к каталогу. Однако в некоторых системах аргумент `mode` игнорируется.

Чтобы изменить права доступа к каталогу, мы рекомендуем функцию `chmod`, которая работает аналогично команде `chmod` в системах Unix. Дополнительную информацию об этом можно найти в документации.

В приведенном выше примере используется другая функция модуля `os` с именем `listdir`. Функция `listdir` возвращает список, содержащий имена файлов и каталогов, которые находятся в пути, переданном в качестве аргумента.

Если ей не передано никаких аргументов, будет использоваться текущий рабочий каталог (как в примере выше). Важно, чтобы результат функции `listdir` не содержал записей `.` и `..`, которые отображаются, например, при использовании команды `ls -a` в системах Unix.

**ПРИМЕЧАНИЕ:** И в Windows, и в Unix есть команда `mkdir`, для которой требуется путь к каталогу. Эквивалентом приведенного выше кода, который создает каталог _my_first_directory_, является команда `mkdir my_first_directory`.


# Рекурсивное создание директории

Функция `mkdir` очень полезна, но что, если Вам нужно создать **другой каталог в каталоге**, который Вы только что создали? Конечно, Вы можете перейти в созданный каталог и создать внутри него другой каталог, но, к счастью, модуль `os` предоставляет функцию под названием `makedirs`, которая упрощает эту задачу.

Функция `makedirs` включает рекурсивное создание каталогов, что означает, что будут созданы все каталоги в пути. Давайте посмотрим на код и проверим, как это работает на практике.

```python
import os

os.makedirs("my_first_directory/my_second_directory")
os.chdir("my_first_directory")
print(os.listdir())

```

Код должен дать следующий результат:

```
['my_second_directory']
```

Код создает два каталога. Первый из них создается в текущем рабочем каталоге, а второй - в каталоге _my_first_directory_.

Вам не нужно переходить в каталог _my_first_directory_, чтобы создать каталог _my_second_directory_, потому что функция `makedirs` делает это за Вас. В приведенном выше примере мы переходим в каталог _my_first_directory_, чтобы показать, что команда `makedirs` создает подкаталог _my_second_directory_.

Для перемещения между каталогами Вы можете использовать функцию под названием `chdir`, которая изменяет текущий рабочий каталог на указанный путь. В качестве аргумента может использоваться любой относительный или абсолютный путь. В нашем примере мы передаем ему имя первого каталога.

**ПРИМЕЧАНИЕ:** эквивалентом функции `makedirs` в системах Unix является команда `mkdir` с флагом `-p`, в то время как в Windows просто команда `mkdir` с путем:

*   Unix-подобные системы:  
      
    ```
    mkdir -p my_first_directory/my_second_directory
    ```
  
*   Windows:  
      
    ```
    mkdir my_first_directory/my_second_directory
    ```


# Где я?

Вы уже знаете, как создавать каталоги и как перемещаться между ними. Иногда, когда у Вас действительно большая структура каталогов, по которой Вы перемещаетесь, Вы можете не знать, в каком каталоге Вы сейчас работаете.


![Lost programmer](./assets/83ab8d8cfb449367a7bb349a63730cb219770c2e.png)


Как Вы, наверное, догадались, модуль `os` предоставляет функцию, которая возвращает информацию о текущем рабочем каталоге. Она называется `getcwd`. Посмотрите на код, чтобы увидеть, как ее использовать на практике.

```python
import os

os.makedirs("my_first_directory/my_second_directory")
os.chdir("my_first_directory")
print(os.getcwd())
os.chdir("my_second_directory")
print(os.getcwd())

```

Результат:

```
.../my_first_directory
.../my_first_directory/my_second_directory
```

В этом примере мы создаем каталог _my_first_directory_ и каталог _my_second_directory_ внутри него. На следующем шаге мы меняем текущий рабочий каталог на каталог _my_first_directory_, а затем отображаем текущий рабочий каталог (первая строка результата).

Затем мы переходим в каталог _my_second_directory_ и снова отображаем текущий рабочий каталог (вторая строка результата). Как видите, функция `getcwd` возвращает абсолютный путь к каталогам.

**ПРИМЕЧАНИЕ:** В Unix-подобных системах эквивалентом функции `getcwd` является команда `pwd`, которая выводит имя текущего рабочего каталога.


# Удаление директорий в Python

Модуль `os` также позволяет удалять каталоги. Это дает Вам возможность удалить отдельный каталог или каталог с его подкаталогами. Чтобы удалить один каталог, Вы можете использовать функцию с именем rmdir, которая принимает путь в качестве аргумента. Посмотрите код.

```python
import os

os.mkdir("my_first_directory")
print(os.listdir())
os.rmdir("my_first_directory")
print(os.listdir())

```

Приведенный выше пример очень прост. Сначала создается каталог _my_first_directory_, а затем он удаляется с помощью функции `rmdir`. Функция `listdir` используется как доказательство того, что каталог был успешно удален. В этом случае он возвращает пустой список. При удалении каталога убедитесь, что он существует и пуст, в противном случае возникнет исключение.

Чтобы удалить каталог и его подкаталоги, Вы можете использовать функцию `deletedirs`, которая требует от Вас указать путь, содержащий все каталоги, которые следует удалить:

```python
import os

os.makedirs("my_first_directory/my_second_directory")
os.removedirs("my_first_directory/my_second_directory")
print(os.listdir())

```

Как и в случае с функцией `rmdir`, если один из каталогов не существует или не пуст, возникает исключение.

**ПРИМЕЧАНИЕ:** и в Windows, и в Unix есть команда `rmdir`, которая, как и функция `rmdir`, удаляет каталоги. Более того, в обеих системах есть команды для удаления каталога и его содержимого. В Unix это команда `rm` с флагом `-r`.


# Функция `system()`

Все функции, представленные в этой части курса, могут быть заменены функцией с именем `system`, которая выполняет команду, переданную ей в виде строки.

Функция `system` доступна как в Windows, так и в Unix. В зависимости от системы она возвращает разный результат.

В Windows он возвращает значение, возвращаемое оболочкой после выполнения данной команды, а в Unix возвращает статус завершения процесса.

Давайте посмотрим на код и проверим, как это работает на практике.

```python
import os

returned_value = os.system("mkdir my_first_directory")
print(returned_value)

```

Результат:

```
0
```

Приведенный выше пример будет работать как в Windows, так и в Unix. В нашем случае мы получаем статус выхода `0`, что указывает на успех в системах Unix.

Это означает, что каталог _my_first_directory_ создан. В рамках упражнения попробуйте перечислить содержимое каталога, в котором Вы создали каталог _my_first_directory_.

  
# Основные тезисы


1. Функция `uname` возвращает объект, содержащий информацию о текущей операционной системе. Объект имеет следующие атрибуты:

   *   `systemname` (хранит имя операционной системы)
   *   `nodename` (хранит имя устройства в сети)
   *   `release` (хранит выпуск операционной системы)
   *   `version` (хранит версию операционной системы)
   *   `machine` (хранит идентификатор оборудования, например x86`64.)

2. Атрибут `name`, доступный в модуле `os`, позволяет Вам идентифицировать операционную систему. Он возвращает одно из следующих трех значений:

   *   `posix` (Вы получите это имя, если используете Unix)
   *   `nt` (Вы получите это имя, если используете Windows)
   *   `java` (Вы получите это имя, если Ваш код написан на чем-то вроде Jython)

3. Функция `mkdir` создает каталог по пути, переданному в качестве аргумента. Путь может быть относительным или абсолютным, например:
    
    ```python
    import os
    
    os.mkdir("hello") # относительный путь
    os.mkdir("/home/python/hello") # абсолютный путь
    
    ```
    
    **Примечание**: Если каталог существует, будет выдано исключение `FileExistsError`. В дополнение к функции `mkdir` модуль `os` предоставляет функцию `makedirs`, которая позволяет рекурсивно создавать все каталоги в пути.

4. Результатом функции `listdir()` является список, содержащий имена файлов и каталогов, которые находятся в пути, переданном в качестве аргумента.
   
   Важно помнить, что функция `listdir` пропускает записи `.` и `..`, которые отображаются, например, при использовании команды `ls -a` в системах Unix. Если путь не указан, результат будет возвращен для текущего рабочего каталога.

5. Для перемещения между каталогами вы можете использовать функцию `chdir()`, которая изменяет текущий рабочий каталог на указанный путь. В качестве аргумента он принимает любой относительный или абсолютный путь.
   
   Если Вы хотите узнать, что такое текущий рабочий каталог, Вы можете использовать функцию `getcwd()`, которая возвращает путь к нему.

6. Чтобы удалить каталог, Вы можете использовать функцию `rmdir()`, но чтобы удалить каталог и его подкаталоги, используйте функцию `deletedirs()`.

7. И в Unix, и в Windows Вы можете использовать системную функцию, которая выполняет команду, переданную ей в виде строки, например:
   
   ```python
   import os
   
   returned_value = os.system("mkdir hello")
   
   ```
   
   Функция `system` в Windows возвращает значение, возвращаемое оболочкой после выполнения данной команды, в то время как в Unix она возвращает статус завершения процесса.


---  


**Упражнение 1**

Что выведет следующий код, если Вы запустите его в Unix?

```python
import os
print(os.name)
```

<details><summary>Проверка</summary>

```
posix
```

</details>

---

**Упражнение 2**

Каков вывод следующего кода?

```python
import os

os.mkdir("hello")
print(os.listdir())
```

<details><summary>Проверка</summary>

```
['hello']
```

</details>




